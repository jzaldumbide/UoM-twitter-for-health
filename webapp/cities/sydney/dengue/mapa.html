<!DOCTYPE html>
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <meta charset="utf-8">
  <title>Heatmaps</title>

  <style>
    html, body, #map-canvas {
      height: 100%;
      margin: 0px;
      padding: 0px
    }
    #panel {
      position: absolute;
      top: 5px;
      left: 50%;
      margin-left: -180px;
      z-index: 5;
      background-color: #fff;
      padding: 5px;
      border: 1px solid #999;
    }
  </style>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=visualization"></script>

  <script>
    google.setOnLoadCallback(getData); 
    var counter=0;
    var datacoord1="";  
    var datacoord2="";  
    var datacoord3=[];
    var map, pointarray, heatmap;
    var map2, pointarray2, heatmap2;

    var datacoord2=[]; 


    function getData(){

        //$.getJSON('http://127.0.0.1:9200/brisbane/_search?&q=dengue&size=10000', //aqui personalizar
          $.getJSON('http://115.146.93.161:9200/sydneyindex/_search?&q=dengue', //remote
          function(data) {
            counter=data.hits.total;//todos los
            for(var i=0;i<counter-1; i++){
             
             datacoord1='new google.maps.LatLng('+data.hits.hits[i]._source.geo.coordinates[0]+','+data.hits.hits[i]._source.geo.coordinates[1]+')';

             
             datacoord1=new google.maps.LatLng(data.hits.hits[i]._source.geo.coordinates[0], data.hits.hits[i]._source.geo.coordinates[1]);
             
             datacoord3.push(datacoord1);
           }

           
           updateheatmap(datacoord3);
         });

      }








      function updateheatmap(datacoord3) {
        changeRadius();
 // datacoord3.toArray();

 console.log(typeof datacoord3);
 console.log(datacoord3);
 

 console.log(typeof datacoord2);

//  console.log( datacoord3);

var mapOptions = {
  zoom: 9,
  center: new google.maps.LatLng(-27.61074407, 153.10321849),
  mapTypeId: google.maps.MapTypeId.SATELLITE
};

map2 = new google.maps.Map(document.getElementById('map-canvas'),
  mapOptions);

var pointArray = new google.maps.MVCArray(datacoord3);
heatmap2 = new google.maps.visualization.HeatmapLayer({
  data: pointArray
});
heatmap2.setMap(map2);

}






function initialize() {
  var mapOptions = {
    zoom: 9,
    center: new google.maps.LatLng(-33.7969235,150.9224326),
    mapTypeId: google.maps.MapTypeId.SATELLITE
  };

  map = new google.maps.Map(document.getElementById('map-canvas'),
    mapOptions);

  var pointArray = new google.maps.MVCArray(datacoord2);

  heatmap = new google.maps.visualization.HeatmapLayer({
    data: pointArray
  });

  heatmap.setMap(map);
}





function changeRadius() {
  heatmap.set('radius', heatmap.get('radius') ? null : 20);
}



google.maps.event.addDomListener(window, 'load', initialize);

</script>
</head>

<body>
  <!-- <div id="panel"> -->
  <!-- <button onclick="toggleHeatmap()">Toggle Heatmap</button> -->
  <!-- <button onclick="changeGradient()">Change gradient</button> -->
  <!-- <button onclick="changeRadius()">Change radius</button> -->
  <!-- <button onclick="changeOpacity()">Change opacity</button> -->
  <!-- </div> -->
  <div id="map-canvas"></div>

</body>
</html>